# -*- coding: utf-8 -*-
"""Weather_R.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1bQGoL1JXCApepmvlZn-fwUPF4GuFgxRD

THIS NOTEBOOK'S USING R AS ITS RUNTIME TYPE
"""

## import data
weather <- read.csv('https://raw.githubusercontent.com/Zufaruu/Weather_Prediction/main/weatherAUS.csv')

## Importing & Installing Library
install.packages('caTools') #Train-Test-Split
library(caTools)

## Data Preprocessing
weather_cleaned = (weather[(!(is.na(weather$MinTemp) | weather$MinTemp=="")) & 
          (!(is.na(weather$MaxTemp) | weather$MaxTemp=="")) &
          (!(is.na(weather$Rainfall) | weather$Rainfall=="")) &  
          (!(is.na(weather$Evaporation) | weather$Evaporation=="")) &
          (!(is.na(weather$Sunshine) | weather$Sunshine=="")) &
          (!(is.na(weather$WindGustDir) | weather$WindGustDir=="")) &
          (!(is.na(weather$WindGustSpeed) | weather$WindGustSpeed=="")) &
          (!(is.na(weather$WindDir9am) | weather$WindDir9am=="")) &
          (!(is.na(weather$WindDir3pm) | weather$WindDir3pm=="")) &
          (!(is.na(weather$WindSpeed9am) | weather$WindSpeed9am=="")) &
          (!(is.na(weather$WindSpeed3pm) | weather$WindSpeed3pm=="")) &
          (!(is.na(weather$Humidity9am) | weather$Humidity9am=="")) &
          (!(is.na(weather$Humidity3pm) | weather$Humidity3pm=="")) &
          (!(is.na(weather$Pressure9am) | weather$Pressure9am=="")) &
          (!(is.na(weather$Pressure3pm) | weather$Pressure3pm=="")) &
          (!(is.na(weather$Cloud9am) | weather$Cloud9am=="")) &
          (!(is.na(weather$Cloud3pm) | weather$Cloud3pm=="")) &
          (!(is.na(weather$Temp9am) | weather$Temp9am=="")) &
          (!(is.na(weather$Temp3pm) | weather$Temp3pm=="")) &
          (!(is.na(weather$RainTomorrow) | weather$RainTomorrow==""))
        , ])
weather_cleaned['RainToday'][weather_cleaned['RainToday'] == 'Yes'] = 1
weather_cleaned['RainToday'][weather_cleaned['RainToday'] == 'No'] = 0
weather_cleaned['RainTomorrow'][weather_cleaned['RainTomorrow'] == 'Yes'] = 1
weather_cleaned['RainTomorrow'][weather_cleaned['RainTomorrow'] == 'No'] = 0
weather_cleaned$RainToday = as.numeric(weather_cleaned$RainToday)
weather_cleaned$RainTomorrow = as.numeric(weather_cleaned$RainTomorrow)

## Train-Test Split
set.seed(69)
split = sample.split(weather_cleaned,SplitRatio = 0.8)
trainc = subset(weather_cleaned,split == TRUE)
testc = subset(weather_cleaned,split == FALSE)

## Preprocess Train & Test Dataset 
trainc_tmr = subset(trainc, select = -c(Date))
testc_tmr= subset(testc, select = -c(Date))

## Doing Logistic Regression
lgr_Rain_Tomorrow = glm(RainTomorrow~., data = trainc_tmr, family = "binomial")
summary(lgr_Rain_Tomorrow)

## Predicting
predict_tmr = predict(lgr_Rain_Tomorrow, testc_tmr, type="response")
predict_tmr = ifelse(predict_tmr > 0.7, 1, 0)
table(testc_tmr$RainTomorrow, predict_tmr)

## Accuracy
paste(as.character( ( (9339+996)*100 / (9339+996+1744+186) )), "%", sep=" ")